package com.notification.service.configuration;

//package com.example.kafka;
import lombok.extern.slf4j.Slf4j;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.messaging.handler.annotation.Payload;
import org.springframework.stereotype.Component;

import com.notification.service.beans.OrderPlacedEvent;

@Slf4j
@Component
public class OrderPlacedListener {

 @KafkaListener(topics = "${app.kafka.topic.orderPlaced}", groupId = "notification-service")
 public void handle(@Payload OrderPlacedEvent event) {
     log.info("Received OrderPlacedEvent: {}", event);

     // यहाँ अपना notification logic लगाएँ (Email/SMS/Push)
     // e.g., emailService.sendOrderConfirmation(event.getUserId(), event.getOrderId());

     // डेमो में फेल करवाना हो तो exception throw करें – retry/DLT behavior देखेंगे
     // if (event.getOrderId().endsWith("BAD")) throw new RuntimeException("Simulated failure");
 }
}

